---

## âœ… **Data Consistency Verification** in Azure Data Factory (ADF)

---

### ğŸ”¹ **What is it?**

> This setting enables **validation checks** to ensure the **data copied from source to sink is accurate and complete** â€” based on **row counts** and/or **checksums**.

In short:

> ADF compares what was read vs. what was written.

---

### ğŸ” **Types of Verifications:**

When **Data Consistency Verification** is enabled, ADF may perform:

1. **Row Count Comparison**

   * âœ… Compares **number of rows read** from source vs **written** to sink

2. **Checksum Verification** *(only for certain connectors)*

   * âœ… Validates content integrity using a **hash value** on rows/columns

---

### âš™ï¸ **Where to enable it:**

* Inside a **Copy Data activity** â†’ **Sink tab** â†’ Additional settings
* Checkbox: **â€œEnable data consistency verificationâ€**

---

### ğŸ§  **When to use it:**

| Scenario                                       | Benefit                            |
| ---------------------------------------------- | ---------------------------------- |
| Copying financial or critical data             | Detect **data loss or corruption** |
| Copying between systems that may fail silently | Catch **partial loads**            |
| Compliance / Auditing requirements             | Ensures **record-level accuracy**  |

---

### âš ï¸ Things to Note:

* Slight **performance impact** (especially with large data sets)

  * Row count validation is lightweight
  * Checksum validation (if applicable) is heavier
* Only works with **compatible connectors** (e.g., Blob â†’ SQL)
* If verification fails, **copy activity will fail** with an error

---

### ğŸ§¾ Example:

You're copying 10 million records from a data lake to Azure SQL:

* **Enabled** â†’ ADF verifies that **10 million rows** went in and out correctly
* If only 9,999,000 made it to the sink â†’ the activity **fails with a mismatch error**

---

### âœ… Summary:

| Setting                       | Purpose                            | Impact                      |
| ----------------------------- | ---------------------------------- | --------------------------- |
| Data Consistency Verification | Ensures source and sink data match | Slight performance overhead |
| Row Count Check               | Compares rows read vs written      | Lightweight                 |
| Checksum Validation           | Compares hash values for integrity | Medium to heavy             |

---

âœ… In Azure Data Factory (ADF), **Data Consistency Verification** ensures that data is **accurately transferred** from the **source to the sink** in a **Copy Activity**.

But the **details of how it works are limited to logs**, and Microsoft doesn't expose full internal verification logic â€” however, **you *can* observe its impact and behavior** through the following methods:

---

## ğŸ” 1. **Monitor Tab (UI Level)**

Go to:

* ADF Studio â†’ **Monitor** â†’ Select your pipeline run â†’ Click on the **Copy Activity**

There youâ€™ll see:

* âœ… **Status** (Succeeded, Failed, Skipped)
* âœ… **Rows read vs. written**
* âœ… **Data consistency verification (enabled/disabled)**

> If the number of **rows read â‰  rows written**, and verification is **enabled**, ADF will **fail the activity**.

ğŸ§  This is your first indication that **consistency check caught a mismatch**.

---

## ğŸ” 2. **Copy Activity Output Logs (Detailed)**

In the **Activity run output** JSON (click the Copy Activity > "Output" tab), look for:

```json
{
  "dataConsistencyVerification": {
    "verificationEnabled": true,
    "verificationStatus": "Passed",
    "rowsRead": 10000,
    "rowsWritten": 10000
  }
}
```

You might see:

* `"verificationStatus": "Passed"` or `"Failed"`
* Row counts that help confirm the match

> ğŸ”§ If consistency fails, it logs a warning or error, and the activity **may fail** depending on your settings.

---

## ğŸ” 3. **Activity Logs via Azure Monitor / Log Analytics (Advanced)**

If you enabled **diagnostic logging** and sent logs to **Log Analytics**:

* You can query it with **Kusto** using `ADFActivityRun` or `ADFActivityRunOutput`
* Search by activity type: `copy`
* Filter by pipeline name, timestamp, etc.

This lets you **automate detection** of consistency issues across many runs.

---

## ğŸ§ª Bonus: Enable/Disable Option

You can turn this on/off in Copy Activity:

* Go to **Copy Activity > Settings**
* Enable or disable **Data Consistency Verification**

> âš ï¸ Disabling this skips row count checks â€” useful for performance, but **risky for accuracy**.

---

### ğŸš« What You *Can't* See:

* ADF doesnâ€™t show *exact row mismatches* (like "row 123 failed")
* It doesnâ€™t show partial content or row-level comparison
* No direct access to checksum-level verification (unless custom logic is added)

---

### âœ… Summary

| Method         | What You See                                 |
| -------------- | -------------------------------------------- |
| Monitor tab    | Success/failure, rows read/written           |
| Output JSON    | Row counts + consistency status              |
| Log Analytics  | Full audit trail (optional setup)            |
| Error messages | If mismatch occurs, youâ€™ll get error details |

---
